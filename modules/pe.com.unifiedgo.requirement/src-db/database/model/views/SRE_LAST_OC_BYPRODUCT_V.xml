<?xml version="1.0"?>
  <database name="VIEW SRE_LAST_OC_BYPRODUCT_V">
    <view name="SRE_LAST_OC_BYPRODUCT_V"><![CDATA[SELECT COALESCE(o.c_order_id, '-') || ol.c_orderline_id AS sre_last_oc_byproduct_v_id, o.ad_client_id, o.ad_org_id, o.isactive, o.updated, o.updatedby, o.created, o.createdby, ol.m_product_id, p.name, o.c_order_id, o.documentno, COALESCE(to_char(date(o.dateordered)), '--') AS dateordered, dctrl.name AS doctypename, dc.em_sco_specialdoctype AS specialdoctype, o.c_bpartner_id, (bp.taxid || ' - ') || bp.name AS partnername, ol.qtyordered, CASE WHEN o.em_ssa_combo_item_id IS NULL THEN CASE WHEN o.em_sim_is_import = 'N' THEN (SELECT scr_combo_item.name FROM scr_combo_item WHERE scr_combo_item.value = 'CompraNacional' LIMIT 1) ELSE (SELECT scr_combo_item.name FROM scr_combo_item WHERE scr_combo_item.value = 'CompraImportacion' LIMIT 1) END ELSE (SELECT scr_combo_item.name FROM scr_combo_item WHERE scr_combo_item.value = o.em_ssa_combo_item_id LIMIT 1) END AS combo, ol.priceactual, ol.linenetamt, text(uomtrl.uomsymbol) AS uom, cur.cursymbol, pterm.name AS paymentterm, pmethod.name AS paymentmethod FROM c_order o, c_orderline ol, c_doctype dc, c_doctype_trl dctrl, c_currency cur, c_bpartner bp, c_uom_trl uomtrl, c_paymentterm pterm, fin_paymentmethod pmethod, m_product p WHERE ol.m_product_id = p.m_product_id AND (dc.em_sco_specialdoctype = 'SREPURCHASEORDER' OR dc.em_sco_specialdoctype = 'SIMPARTIAL') AND (o.docstatus IN ('CO', 'CL')) AND dctrl.ad_language = 'es_PE' AND uomtrl.ad_language = 'es_PE' AND o.c_bpartner_id = bp.c_bpartner_id AND o.c_order_id = ol.c_order_id AND o.c_doctypetarget_id = dc.c_doctype_id AND o.fin_paymentmethod_id = pmethod.fin_paymentmethod_id AND o.c_paymentterm_id = pterm.c_paymentterm_id AND o.c_currency_id = cur.c_currency_id AND dc.c_doctype_id = dctrl.c_doctype_id AND ol.c_uom_id = uomtrl.c_uom_id ORDER BY o.dateordered DESC, o.documentno]]></view>
  </database>
