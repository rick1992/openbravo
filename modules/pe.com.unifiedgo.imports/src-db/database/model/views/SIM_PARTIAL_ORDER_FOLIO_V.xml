<?xml version="1.0"?>
  <database name="VIEW SIM_PARTIAL_ORDER_FOLIO_V">
    <view name="SIM_PARTIAL_ORDER_FOLIO_V"><![CDATA[SELECT COALESCE(o.sim_orderimport_id, '-') || p.c_order_id AS sim_partial_order_folio_v_id, p.ad_client_id, p.ad_org_id, p.isactive, p.updated, p.updatedby, p.created, p.createdby, p.c_bpartner_id, p.em_sim_orderimport_id, o.documentno, f.sim_folioimport_id, f.canal, CASE WHEN o.date_approval_partner IS NULL OR o.dateordered IS NULL THEN 0 ELSE to_number(o.date_approval_partner - o.dateordered) END AS dias_confirmacion, CASE WHEN f.datetoforwarder IS NULL OR o.date_approval_partner IS NULL THEN 0 ELSE to_number(f.datetoforwarder - o.date_approval_partner) END AS consolidacion_de_carga, CASE WHEN f.dateshipment IS NULL OR f.datetoforwarder IS NULL THEN 0 ELSE to_number(f.dateshipment - f.datetoforwarder) END AS dias_para_embarque, CASE WHEN f.datearrival IS NULL OR f.dateshipment IS NULL THEN 0 ELSE to_number(f.datearrival - f.dateshipment) END AS dias_de_travesia, CASE WHEN f.fecha_descarga IS NULL OR f.datearrival IS NULL THEN 0 ELSE to_number(f.fecha_descarga - f.datearrival) END AS dias_de_descarga, CASE WHEN f.fecha_volante IS NULL OR f.fecha_descarga IS NULL THEN 0 ELSE to_number(f.fecha_volante - f.fecha_descarga) END AS dias_para_emision_volante, CASE WHEN f.datedua IS NULL OR f.fecha_volante IS NULL THEN 0 ELSE to_number(f.datedua - f.fecha_volante) END AS dias_para_numeracion, CASE WHEN f.fecha_cancelacion IS NULL OR f.datedua IS NULL THEN 0 ELSE to_number(f.fecha_cancelacion - f.datedua) END AS dias_pago_dam, CASE WHEN f.fecha_levante IS NULL OR f.fecha_cancelacion IS NULL THEN 0 ELSE to_number(f.fecha_levante - f.fecha_cancelacion) END AS dias_para_levante, CASE WHEN f.datewarehouse IS NULL OR f.fecha_levante IS NULL THEN 0 ELSE to_number(f.datewarehouse - f.fecha_levante) END AS dias_ingreso_almacen, CASE WHEN p.em_sim_freight = 0 THEN 0 ELSE p.totallines / p.em_sim_freight END AS factor_flete, COALESCE(to_number(f.datetoforwarder - o.date_approval_partner), 0) + COALESCE(to_number(f.dateshipment - f.datetoforwarder), 0) + COALESCE(to_number(f.datearrival - f.dateshipment), 0) + COALESCE(to_number(f.fecha_descarga - f.datearrival), 0) + COALESCE(to_number(f.fecha_volante - f.fecha_descarga), 0) + COALESCE(to_number(f.datedua - f.fecha_volante), 0) + COALESCE(to_number(f.fecha_cancelacion - f.datedua), 0) + COALESCE(to_number(f.fecha_levante - f.fecha_cancelacion), 0) + COALESCE(to_number(f.datewarehouse - f.fecha_levante), 0) + COALESCE(to_number(f.datewarehouse - o.date_approval_partner), 0) AS dias_lead_time FROM c_order p JOIN sim_folioimport f ON f.sim_folioimport_id = p.em_sim_folioimport_id JOIN sim_orderimport o ON o.sim_orderimport_id = p.em_sim_orderimport_id WHERE p.em_sim_is_import = 'Y' AND p.em_sim_is_in_folio = 'Y' AND f.docstatus = 'CO']]></view>
  </database>
