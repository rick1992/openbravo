<?xml version="1.0"?>
  <database name="VIEW SSA_PROJECT_PROPERTY_INV_V">
    <view name="SSA_PROJECT_PROPERTY_INV_V"><![CDATA[SELECT DISTINCT ON (ps.c_invoice_id, ps.ssa_project_property_id) (ps.ssa_contract_payment_sched_id || ps.ssa_projprop_contract_id) || ps.c_invoice_id AS ssa_project_property_inv_v_id, ps.ad_client_id, ps.ad_org_id, ps.isactive, ps.created, ps.createdby, ps.updated, ps.updatedby, ps.ssa_projprop_contract_id, ps.c_currency_id, ps.ssa_project_property_id, ps.c_invoice_id AS documentid, ps.ssa_contract_payment_sched_id, (SELECT cl.linestatus FROM ssa_projprop_contract_line cl WHERE cl.ssa_projprop_contract_id = c.ssa_projprop_contract_id AND cl.ssa_project_property_id = ps.ssa_project_property_id LIMIT 1) AS linestatus, ps.amount FROM ssa_contract_payment_sched ps JOIN ssa_projprop_contract c ON c.ssa_projprop_contract_id = ps.ssa_projprop_contract_id WHERE ps.c_invoice_id IS NOT NULL AND c.docstatus <> 'DR' UNION ALL SELECT DISTINCT ON (ps.creditmemo_id, ps.ssa_project_property_id) (ps.ssa_contract_payment_sched_id || ps.ssa_projprop_contract_id) || ps.creditmemo_id AS ssa_project_property_inv_v_id, ps.ad_client_id, ps.ad_org_id, ps.isactive, ps.created, ps.createdby, ps.updated, ps.updatedby, ps.ssa_projprop_contract_id, ps.c_currency_id, ps.ssa_project_property_id, ps.creditmemo_id AS documentid, ps.ssa_contract_payment_sched_id, '--' AS linestatus, ps.amount FROM ssa_contract_payment_sched ps JOIN ssa_projprop_contract c ON c.ssa_projprop_contract_id = ps.ssa_projprop_contract_id WHERE ps.creditmemo_id IS NOT NULL AND c.docstatus <> 'DR']]></view>
  </database>
