<?xml version="1.0"?>
  <database name="VIEW SIM_ORDERIMPORT_PENDING">
    <view name="SIM_ORDERIMPORT_PENDING"><![CDATA[SELECT DISTINCT COALESCE(oi.sim_orderimport_id, oi.c_bpartner_id) || oi.ad_org_id AS sim_orderimport_pending_id, to_char('Y') AS isactive, oi.updated, oi.updatedby, oi.created, oi.createdby, oi.sim_orderimport_id, oi.ad_client_id, oi.ad_org_id, oi.c_bpartner_id, oi.dateordered, oi.datepromised, oi.date_approval_partner, oi.c_currency_id, oi.documentno, COALESCE(round(oi.qty_ordered, 2), 0) AS qtyordered, COALESCE(round(oi.qty_received, 2), 0) AS qtyreceived, round(oi.grandtotal_aplic_discount, 2) AS grandtotal FROM sim_orderimport oi JOIN sim_orderimportline oil ON oi.sim_orderimport_id = oil.sim_orderimport_id WHERE oi.docstatus = 'CO' AND oi.dateordered > '2017-01-08 00:00:00' AND oi.date_approval_partner IS NULL AND trunc((now() - 7)) > oi.dateordered GROUP BY oi.sim_orderimport_id, oi.ad_client_id, oi.ad_org_id, oi.dateordered, oi.date_approval_partner, oi.datepromised, oi.c_bpartner_id, oi.documentno, oi.qty_ordered, oi.qty_received, oi.grandtotal_aplic_discount, oi.docstatus, oi.c_currency_id, oi.updated, oi.updatedby, oi.created, oi.createdby HAVING (COALESCE(round(oi.qty_ordered, 2), 0) - COALESCE(round(oi.qty_received, 2), 0)) > 0 ORDER BY oi.dateordered DESC]]></view>
  </database>
