<?xml version="1.0"?>
  <database name="VIEW SWA_REPOSITIONPENDINGRCPT">
    <view name="SWA_REPOSITIONPENDINGRCPT"><![CDATA[SELECT DISTINCT COALESCE(c.ad_org_id, '-') || COALESCE(c.swa_requerimientoreposicion_id, '-') AS swa_repositionpendingrcpt_id, 'Y' AS isactive, c.updated, c.updatedby, c.created, c.createdby, c.ad_client_id, c.ad_org_id, c.swa_requerimientoreposicion_id, c.movementdate, c.documentno, sum(c.qtyshipment) AS qtyshipment, sum(c.qtyreceipt) AS qtyreceipt, sum(c.qtydif) AS qtydif, c.from_m_warehouse_id, c.to_m_warehouse_id FROM (SELECT a.updated, a.updatedby, a.created, a.createdby, a.ad_client_id, a.ad_org_id, a.swa_requerimientoreposicion_id, a.from_m_warehouse_id, a.to_m_warehouse_id, a.movementdate, a.documentno, a.m_product_id, a.qtyshipment, COALESCE(sum(riol.movementqty), 0) AS qtyreceipt, COALESCE(sum(ariol.movementqty), 0) AS qtyreceiptafter, a.qtyshipment - COALESCE(sum(riol.movementqty), 0) AS qtydif FROM (SELECT str.updated, str.updatedby, str.created, str.createdby, str.ad_client_id, str.ad_org_id, str.swa_requerimientoreposicion_id, str.from_m_warehouse_id, str.to_m_warehouse_id, io.movementdate, str.documentno, iol.m_product_id, COALESCE(sum(iol.movementqty), 0) AS qtyshipment FROM swa_requerimientoreposicion str JOIN m_inout io ON str.swa_requerimientoreposicion_id = io.em_swa_requireposicion_id AND io.issotrx = 'Y' AND io.docstatus = 'CO' JOIN m_inoutline iol ON io.m_inout_id = iol.m_inout_id WHERE str.specialdoctype = 'SWAREPOSITION' AND 1 = 1 GROUP BY str.updated, str.updatedby, str.created, str.createdby, str.ad_org_id, str.ad_client_id, iol.m_product_id, str.documentno, io.movementdate, str.swa_requerimientoreposicion_id, str.from_m_warehouse_id, str.to_m_warehouse_id) a LEFT JOIN swa_requerimientoreposicion rtr ON a.swa_requerimientoreposicion_id = rtr.swa_fromrequerimiento_id LEFT JOIN m_inout rio ON rtr.swa_requerimientoreposicion_id = rio.em_swa_requireposicion_id AND rio.issotrx = 'N' AND rio.docstatus = 'CO' LEFT JOIN m_inoutline riol ON rio.m_inout_id = riol.m_inout_id AND riol.m_product_id = a.m_product_id LEFT JOIN m_inout ario ON rtr.swa_requerimientoreposicion_id = ario.em_swa_requireposicion_id AND ario.issotrx = 'N' AND ario.docstatus = 'CO' LEFT JOIN m_inoutline ariol ON ario.m_inout_id = ariol.m_inout_id AND ariol.m_product_id = a.m_product_id GROUP BY a.updated, a.updatedby, a.created, a.createdby, a.ad_client_id, a.ad_org_id, a.movementdate, a.m_product_id, a.swa_requerimientoreposicion_id, a.documentno, a.qtyshipment, a.from_m_warehouse_id, a.to_m_warehouse_id HAVING (a.qtyshipment - COALESCE(sum(riol.movementqty), 0)) > 0) c GROUP BY c.ad_org_id, c.swa_requerimientoreposicion_id, c.movementdate, c.documentno, c.updated, c.updatedby, c.created, c.createdby, c.ad_client_id, c.from_m_warehouse_id, c.to_m_warehouse_id]]></view>
  </database>
