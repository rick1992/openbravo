<?xml version="1.0"?>
  <database name="VIEW SCO_FACC_TRANSAC_DETAIL_V">
    <view name="SCO_FACC_TRANSAC_DETAIL_V"><![CDATA[SELECT (COALESCE(finacc.fin_finacc_transaction_id, '-') || COALESCE(max(pd.fin_payment_detail_id), '-')) || COALESCE(finacc.c_glitem_id, '-') AS sco_facc_transac_detail_v_id, finacc.ad_client_id, finacc.ad_org_id, finacc.isactive, finacc.updated, finacc.updatedby, finacc.created, finacc.createdby, finacc.fin_financial_account_id, finacc.fin_reconciliation_id, finacc.fin_finacc_transaction_id, p.fin_payment_id, psi.c_invoice_id, finacc.dateacct, finacc.statementdate, CASE WHEN finacc.c_glitem_id IS NOT NULL THEN finacc.c_glitem_id ELSE gli.c_glitem_id END AS c_glitem_id, finacc.description, CASE WHEN finacc.c_glitem_id IS NOT NULL THEN finacc.paymentamt WHEN finacc.fin_payment_id IS NOT NULL THEN CASE WHEN sum(pd.em_sco_paymentamount) > 0 AND p.isreceipt = 'N' OR sum(pd.em_sco_paymentamount) < 0 AND p.isreceipt = 'Y' THEN abs(sum(pd.em_sco_paymentamount)) ELSE 0.00 END ELSE NULL END AS paymentamt, CASE WHEN finacc.c_glitem_id IS NOT NULL THEN finacc.depositamt WHEN finacc.fin_payment_id IS NOT NULL THEN CASE WHEN sum(pd.em_sco_paymentamount) > 0 AND p.isreceipt = 'Y' OR sum(pd.em_sco_paymentamount) < 0 AND p.isreceipt = 'N' THEN abs(sum(pd.em_sco_paymentamount)) ELSE 0.00 END ELSE NULL END AS depositamt, CASE WHEN finacc.fin_reconciliation_id IS NOT NULL THEN CASE WHEN rec.posted = 'Y' THEN 'Y' WHEN finacc.posted = 'Y' THEN 'Y' WHEN finacc.fin_payment_id IS NOT NULL THEN CASE WHEN p.posted = 'Y' THEN 'Y' ELSE 'N' END ELSE 'N' END WHEN finacc.posted = 'Y' THEN 'Y' WHEN finacc.fin_payment_id IS NOT NULL THEN CASE WHEN p.posted = 'Y' THEN 'Y' ELSE 'N' END ELSE 'N' END AS posted FROM fin_finacc_transaction finacc LEFT JOIN fin_reconciliation rec ON finacc.fin_reconciliation_id = rec.fin_reconciliation_id LEFT JOIN fin_payment p ON finacc.fin_payment_id = p.fin_payment_id LEFT JOIN fin_payment_detail pd ON p.fin_payment_id = pd.fin_payment_id LEFT JOIN fin_payment_scheduledetail psd ON pd.fin_payment_detail_id = psd.fin_payment_detail_id LEFT JOIN fin_payment_schedule psi ON psd.fin_payment_schedule_invoice = psi.fin_payment_schedule_id LEFT JOIN c_glitem gli ON pd.c_glitem_id = gli.c_glitem_id GROUP BY finacc.ad_client_id, finacc.ad_org_id, finacc.isactive, finacc.updated, finacc.updatedby, finacc.created, finacc.createdby, finacc.fin_financial_account_id, finacc.fin_reconciliation_id, finacc.fin_finacc_transaction_id, p.fin_payment_id, psi.c_invoice_id, gli.c_glitem_id, finacc.c_glitem_id, finacc.description, finacc.paymentamt, finacc.depositamt, finacc.fin_payment_id, p.isreceipt, finacc.statementdate, finacc.dateacct, rec.posted, finacc.posted, p.posted ORDER BY finacc.statementdate DESC]]></view>
  </database>
