<?xml version="1.0"?>
  <database name="VIEW SRE_PURCHASEORDER_PENDING">
    <view name="SRE_PURCHASEORDER_PENDING"><![CDATA[SELECT COALESCE(o.c_order_id, o.c_bpartner_id) || o.ad_org_id AS sre_purchaseorder_pending_id, o.c_order_id, o.ad_client_id, o.ad_org_id, to_char('Y') AS isactive, o.updated, o.updatedby, o.created, o.createdby, o.dateordered, o.c_bpartner_id, o.c_currency_id, o.datepromised, o.grandtotal, round(COALESCE(sum(ol.qtyordered), 0), 2) AS qtyordered, round(COALESCE(sum(ol.qtyreserved), 0) * (-1), 2) AS qtyreceived, round(COALESCE(sum(ol.qtyordered), 0) + COALESCE(sum(ol.qtyreserved), 0), 2) AS qtydifference FROM c_order o JOIN ad_org org ON o.ad_org_id = org.ad_org_id JOIN c_bpartner cbp ON o.c_bpartner_id = cbp.c_bpartner_id JOIN c_orderline ol ON o.c_order_id = ol.c_order_id JOIN c_doctype dt ON o.c_doctype_id = dt.c_doctype_id WHERE o.docstatus = 'CO' AND o.issotrx = 'N' AND dt.em_sco_specialdoctype = 'SREPURCHASEORDER' AND o.em_ssa_isserviceorder = 'N' GROUP BY o.c_order_id, o.ad_client_id, o.ad_org_id, o.dateordered, o.datepromised, o.c_bpartner_id, o.c_currency_id, o.grandtotal, o.updated, o.updatedby, o.created, o.createdby HAVING (COALESCE(sum(ol.qtyordered), 0) + COALESCE(sum(ol.qtyreserved), 0)) > 0 AND o.dateordered >= '2017-01-08 00:00:00' AND o.dateordered <= trunc((now() - 7)) ORDER BY o.dateordered DESC]]></view>
  </database>
