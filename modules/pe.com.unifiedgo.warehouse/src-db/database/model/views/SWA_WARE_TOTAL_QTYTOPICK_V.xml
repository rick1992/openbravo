<?xml version="1.0"?>
  <database name="VIEW SWA_WARE_TOTAL_QTYTOPICK_V">
    <view name="SWA_WARE_TOTAL_QTYTOPICK_V"><![CDATA[SELECT (COALESCE(a.m_warehouse_id, '-') || COALESCE(a.m_product_id, '-')) || COALESCE(a.ad_org_id, '-') AS swa_ware_total_qtytopick_v_id, a.m_product_id, a.m_warehouse_id, a.qtyonhand, a.qtyreserved, a.ad_client_id, a.ad_org_id, 'Y' AS isactive, now() AS updated, '100' AS updatedby, now() AS created, '100' AS createdby FROM (SELECT sd.m_product_id, sd.m_warehouse_id, sd.qtyonhand, COALESCE(s.qtyreserved, 0) AS qtyreserved, sd.ad_client_id, sd.ad_org_id FROM (SELECT sdd.m_product_id, l.m_warehouse_id, sum(sdd.qtyonhand) AS qtyonhand, sdd.ad_client_id, l.ad_org_id FROM m_storage_detail sdd JOIN m_locator l ON sdd.m_locator_id = l.m_locator_id WHERE COALESCE(l.em_obwhs_type, '') <> 'swa_RCP' GROUP BY sdd.m_product_id, l.m_warehouse_id, sdd.ad_client_id, l.ad_org_id) sd LEFT JOIN (SELECT spp.m_product_id, spp.m_warehouse_id, sum(spp.qtyreserved) AS qtyreserved FROM (SELECT m_reservation.m_product_id, CASE WHEN m_reservation.c_orderline_id IS NOT NULL THEN (SELECT o.m_warehouse_id FROM c_order o JOIN c_orderline ol ON o.c_order_id = ol.c_order_id WHERE ol.c_orderline_id = m_reservation.c_orderline_id) ELSE m_reservation.m_warehouse_id END AS m_warehouse_id, m_reservation.reservedqty - m_reservation.releasedqty AS qtyreserved FROM m_reservation WHERE (m_reservation.res_status = 'CO' OR m_reservation.res_status = 'HO') AND m_reservation.reservedqty <> m_reservation.releasedqty) spp GROUP BY spp.m_product_id, spp.m_warehouse_id) s ON sd.m_product_id = s.m_product_id AND sd.m_warehouse_id = s.m_warehouse_id) a]]></view>
  </database>
