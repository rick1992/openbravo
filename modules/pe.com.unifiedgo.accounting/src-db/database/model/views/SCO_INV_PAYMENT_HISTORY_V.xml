<?xml version="1.0"?>
  <database name="VIEW SCO_INV_PAYMENT_HISTORY_V">
    <view name="SCO_INV_PAYMENT_HISTORY_V"><![CDATA[SELECT psd.fin_payment_scheduledetail_id AS sco_inv_payment_history_v_id, psd.ad_client_id, psd.ad_org_id, psd.created, psd.createdby, psd.updated, psd.updatedby, psd.isactive, ps.c_invoice_id, psd.amount + psd.writeoffamt AS amount, p.paymentdate FROM fin_payment_scheduledetail psd JOIN fin_payment_detail pd ON psd.fin_payment_detail_id = pd.fin_payment_detail_id JOIN fin_payment p ON pd.fin_payment_id = p.fin_payment_id JOIN fin_payment_schedule ps ON psd.fin_payment_schedule_invoice = ps.fin_payment_schedule_id WHERE p.status NOT IN ('RPAP', 'RPAE') UNION ALL SELECT psd.fin_payment_scheduledetail_id AS sco_inv_payment_history_v_id, psd.ad_client_id, psd.ad_org_id, psd.created, psd.createdby, psd.updated, psd.updatedby, psd.isactive, psd.em_sco_invoice_glref_id AS c_invoice_id, CASE WHEN p.isreceipt = 'Y' AND i.issotrx = 'Y' THEN psd.amount WHEN p.isreceipt = 'N' AND i.issotrx = 'N' THEN psd.amount ELSE '-1' * psd.amount END AS amount, p.paymentdate FROM fin_payment_scheduledetail psd JOIN c_invoice i ON psd.em_sco_invoice_glref_id = i.c_invoice_id JOIN fin_payment_detail pd ON psd.fin_payment_detail_id = pd.fin_payment_detail_id JOIN fin_payment p ON pd.fin_payment_id = p.fin_payment_id JOIN c_glitem gl ON pd.c_glitem_id = gl.c_glitem_id WHERE gl.name LIKE '12%' AND (p.status NOT IN ('RPAP', 'RPAE')) UNION ALL SELECT bfd.sco_boefrom_payschedetail_id AS sco_inv_payment_history_v_id, bfd.ad_client_id, bfd.ad_org_id, bfd.created, bfd.createdby, bfd.updated, bfd.updatedby, bfd.isactive, bf.invoiceref_id AS c_invoice_id, bfd.amount, b.dateacct AS paymentdate FROM sco_boefrom_payschedetail bfd JOIN sco_boe_from bf ON bfd.sco_boe_from_id = bf.sco_boe_from_id JOIN sco_billofexchange b ON bf.sco_billofexchange_id = b.sco_billofexchange_id UNION ALL SELECT bfd.sco_pwlrecli_payschedetail_id AS sco_inv_payment_history_v_id, bfd.ad_client_id, bfd.ad_org_id, bfd.created, bfd.createdby, bfd.updated, bfd.updatedby, bfd.isactive, bf.invoiceref_id AS c_invoice_id, bfd.amount, b.dateacct AS paymentdate FROM sco_pwlrecli_payschedetail bfd JOIN sco_pwithho_rec_line bf ON bfd.sco_pwithho_rec_line_id = bf.sco_pwithho_rec_line_id JOIN sco_pwithholding_receipt b ON bf.sco_pwithholding_receipt_id = b.sco_pwithholding_receipt_id UNION ALL SELECT bfd.sco_swlrecli_payschedetail_id AS sco_inv_payment_history_v_id, bfd.ad_client_id, bfd.ad_org_id, bfd.created, bfd.createdby, bfd.updated, bfd.updatedby, bfd.isactive, bf.invoiceref_id AS c_invoice_id, bfd.amount, b.dateacct AS paymentdate FROM sco_swlrecli_payschedetail bfd JOIN sco_swithho_rec_line bf ON bfd.sco_swithho_rec_line_id = bf.sco_swithho_rec_line_id JOIN sco_swithholding_receipt b ON bf.sco_swithholding_receipt_id = b.sco_swithholding_receipt_id ORDER BY 11, 9]]></view>
  </database>
